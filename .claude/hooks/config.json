{
  "version": "2026-ultimate-optimized",
  "lastUpdated": "2026-02-06",

  "tokenOptimization": {
    "enabled": true,
    "agentMode": "lite",
    "agentPaths": {
      "lite": ".claude/agents-lite/",
      "full": ".claude/agents-full/"
    },
    "dynamicLoading": {
      "enabled": true,
      "alwaysLoad": ["chief", "confidence-agent"],
      "loadOnDemand": true,
      "triggers": {
        "database-agent": ["database", "schema", "migration", "query", "sql", "prisma"],
        "ui-agent": ["component", "react", "vue", "ui", "frontend", "css", "style"],
        "test-agent": ["test", "coverage", "jest", "spec", "vitest"],
        "security-agent": ["security", "auth", "encryption", "password", "token"],
        "planner": ["plan", "decompose", "breakdown", "swarm"],
        "verifier": ["verify", "validate", "review", "quality"],
        "reflection-agent": ["reflect", "evaluate", "improve"],
        "performance-optimizer": ["performance", "optimize", "speed", "latency"],
        "doc-agent": ["document", "readme", "docs", "api-docs"],
        "refactor-agent": ["refactor", "cleanup", "dead-code"],
        "architecture-agent": ["architecture", "design", "pattern"],
        "infrastructure-agent": ["deploy", "infra", "ci", "cd", "kubernetes"],
        "bug-resolver": ["bug", "fix", "debug", "error"],
        "e2e-runner": ["e2e", "playwright", "cypress", "browser"]
      }
    },
    "contextManagement": {
      "compactThreshold": 0.70,
      "maxHistoryTurns": 6,
      "summarizeAfterTurns": 10,
      "preserveOnCompact": ["current_task", "active_plan", "pending_approvals", "error_context"],
      "summarizeOnCompact": ["completed_tasks", "tool_outputs", "conversation_history"]
    },
    "outputCompression": {
      "enabled": true,
      "maxToolResponseLines": 50,
      "truncateLongOutputs": true,
      "compressJsonResponses": true,
      "useCompactFormat": true
    }
  },

  "sessionStart": {
    "enabled": true,
    "autoLoadLedger": true,
    "autoLoadHandoff": true,
    "showWelcomeMessage": true,
    "maxLedgerAge": 86400000,
    "useLiteAgents": true,
    "debug": false
  },

  "preToolUse": {
    "enabled": true,
    "typeScriptValidation": true,
    "budgetCheck": false,
    "budgetLimit": 50.0,
    "openSpecValidation": false,
    "debug": false
  },

  "postToolUse": {
    "enabled": true,
    "updateCodebaseMap": true,
    "indexArtifacts": true,
    "autoLint": true,
    "autoTest": true,
    "triggerReflection": true,
    "qualityGates": {
      "enabled": true,
      "lintCommand": "npm run lint -- --fix",
      "testCommand": "npm test -- --watch=false --passWithNoTests",
      "coverageThreshold": 80
    },
    "reflection": {
      "enabled": true,
      "agent": "@ReflectionAgent",
      "triggerOnFileTypes": [".ts", ".tsx", ".js", ".jsx"],
      "minChangesForTrigger": 10,
      "scoreThreshold": 70
    },
    "debug": false
  },

  "preCompact": {
    "enabled": true,
    "blockCompaction": false,
    "proactiveCompact": true,
    "compactThreshold": 0.70,
    "requireHandoff": true,
    "handoffMaxAge": 3600000,
    "allowOverride": true,
    "debug": false
  },

  "sessionEnd": {
    "enabled": true,
    "promptForHandoff": true,
    "extractLearnings": true,
    "cleanupOldLedgers": true,
    "ledgerMaxAge": 604800000,
    "debug": false
  },

  "iteration": {
    "enabled": true,
    "maxIterations": 5,
    "defaultTimeout": 300000,
    "agents": ["@PerformanceOptimizer", "@TestAgent", "@SecurityAgent", "@ReflectionAgent"],
    "successCriteria": {
      "performance": "measurable_target",
      "coverage": "percentage_threshold",
      "security": "zero_critical_vulnerabilities"
    }
  },

  "planning": {
    "enabled": true,
    "plannerAgent": "@Planner",
    "verifierAgent": "@Verifier",
    "autoDecompose": true,
    "minTasksForPlanning": 3,
    "confidenceRouting": {
      "autoProceed": 70,
      "queueForReview": 40,
      "blockForHuman": 0
    }
  },

  "global": {
    "debug": false,
    "logFile": ".claude/hooks/debug.log",
    "gracefulFailure": true
  },

  "_comments": {
    "tokenOptimization": "Token usage reduction settings - see TOKEN_OPTIMIZATION_RESEARCH.md",
    "agentMode": "lite = minimal tokens, full = comprehensive (use for complex tasks)",
    "dynamicLoading": "Load agents on-demand based on task keywords",
    "contextManagement": "Proactive compaction and history limiting",
    "outputCompression": "Compress tool outputs to reduce context usage",
    "compactThreshold": "Trigger compaction at 70% context usage (not 95%)",
    "maxHistoryTurns": "Keep only last 6 conversation turns",
    "maxLedgerAge": "24 hours in milliseconds (86400000)",
    "handoffMaxAge": "1 hour in milliseconds (3600000)",
    "ledgerMaxAge": "7 days in milliseconds (604800000)",
    "budgetLimit": "Dollar amount threshold for budget warnings",
    "gracefulFailure": "If true, hooks continue execution on errors"
  }
}
